"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.internalUpdateSchema = exports.internalCreateSchema = exports.SchemasRouter = void 0;
var _PromiseRouter = _interopRequireDefault(require("../PromiseRouter"));
var middleware = _interopRequireWildcard(require("../middlewares"));
function _getRequireWildcardCache(e) { if ("function" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }
function _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || "object" != typeof e && "function" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if ("default" !== u && Object.prototype.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
// schemas.js

var Parse = require('parse/node').Parse,
  SchemaController = require('../Controllers/SchemaController');
function classNameMismatchResponse(bodyClass, pathClass) {
  throw new Parse.Error(Parse.Error.INVALID_CLASS_NAME, `Class name mismatch between ${bodyClass} and ${pathClass}.`);
}
function getAllSchemas(req) {
  return req.config.database.loadSchema({
    clearCache: true
  }).then(schemaController => schemaController.getAllClasses({
    clearCache: true
  })).then(schemas => ({
    response: {
      results: schemas
    }
  }));
}
function getOneSchema(req) {
  const className = req.params.className;
  return req.config.database.loadSchema({
    clearCache: true
  }).then(schemaController => schemaController.getOneSchema(className, true)).then(schema => ({
    response: schema
  })).catch(error => {
    if (error === undefined) {
      throw new Parse.Error(Parse.Error.INVALID_CLASS_NAME, `Class ${className} does not exist.`);
    } else {
      throw new Parse.Error(Parse.Error.INTERNAL_SERVER_ERROR, 'Database adapter error.');
    }
  });
}
const checkIfDefinedSchemasIsUsed = req => {
  var _req$config;
  if (((_req$config = req.config) === null || _req$config === void 0 || (_req$config = _req$config.schema) === null || _req$config === void 0 ? void 0 : _req$config.lockSchemas) === true) {
    throw new Parse.Error(Parse.Error.OPERATION_FORBIDDEN, 'Cannot perform this operation when schemas options is used.');
  }
};
const internalCreateSchema = async (className, body, config) => {
  const controller = await config.database.loadSchema({
    clearCache: true
  });
  const response = await controller.addClassIfNotExists(className, body.fields, body.classLevelPermissions, body.indexes);
  return {
    response
  };
};
exports.internalCreateSchema = internalCreateSchema;
const internalUpdateSchema = async (className, body, config) => {
  const controller = await config.database.loadSchema({
    clearCache: true
  });
  const response = await controller.updateClass(className, body.fields || {}, body.classLevelPermissions, body.indexes, config.database);
  return {
    response
  };
};
exports.internalUpdateSchema = internalUpdateSchema;
async function createSchema(req) {
  checkIfDefinedSchemasIsUsed(req);
  if (req.auth.isReadOnly) {
    throw new Parse.Error(Parse.Error.OPERATION_FORBIDDEN, "read-only masterKey isn't allowed to create a schema.");
  }
  if (req.params.className && req.body.className) {
    if (req.params.className != req.body.className) {
      return classNameMismatchResponse(req.body.className, req.params.className);
    }
  }
  const className = req.params.className || req.body.className;
  if (!className) {
    throw new Parse.Error(135, `POST ${req.path} needs a class name.`);
  }
  return await internalCreateSchema(className, req.body, req.config);
}
function modifySchema(req) {
  checkIfDefinedSchemasIsUsed(req);
  if (req.auth.isReadOnly) {
    throw new Parse.Error(Parse.Error.OPERATION_FORBIDDEN, "read-only masterKey isn't allowed to update a schema.");
  }
  if (req.body.className && req.body.className != req.params.className) {
    return classNameMismatchResponse(req.body.className, req.params.className);
  }
  const className = req.params.className;
  return internalUpdateSchema(className, req.body, req.config);
}
const deleteSchema = req => {
  if (req.auth.isReadOnly) {
    throw new Parse.Error(Parse.Error.OPERATION_FORBIDDEN, "read-only masterKey isn't allowed to delete a schema.");
  }
  if (!SchemaController.classNameIsValid(req.params.className)) {
    throw new Parse.Error(Parse.Error.INVALID_CLASS_NAME, SchemaController.invalidClassNameMessage(req.params.className));
  }
  return req.config.database.deleteSchema(req.params.className).then(() => ({
    response: {}
  }));
};
class SchemasRouter extends _PromiseRouter.default {
  mountRoutes() {
    this.route('GET', '/schemas', middleware.promiseEnforceMasterKeyAccess, getAllSchemas);
    this.route('GET', '/schemas/:className', middleware.promiseEnforceMasterKeyAccess, getOneSchema);
    this.route('POST', '/schemas', middleware.promiseEnforceMasterKeyAccess, createSchema);
    this.route('POST', '/schemas/:className', middleware.promiseEnforceMasterKeyAccess, createSchema);
    this.route('PUT', '/schemas/:className', middleware.promiseEnforceMasterKeyAccess, modifySchema);
    this.route('DELETE', '/schemas/:className', middleware.promiseEnforceMasterKeyAccess, deleteSchema);
  }
}
exports.SchemasRouter = SchemasRouter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfUHJvbWlzZVJvdXRlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwibWlkZGxld2FyZSIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlIiwiZSIsIldlYWtNYXAiLCJyIiwidCIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiaGFzIiwiZ2V0IiwibiIsIl9fcHJvdG9fXyIsImEiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsInUiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJpIiwic2V0Iiwib2JqIiwiUGFyc2UiLCJTY2hlbWFDb250cm9sbGVyIiwiY2xhc3NOYW1lTWlzbWF0Y2hSZXNwb25zZSIsImJvZHlDbGFzcyIsInBhdGhDbGFzcyIsIkVycm9yIiwiSU5WQUxJRF9DTEFTU19OQU1FIiwiZ2V0QWxsU2NoZW1hcyIsInJlcSIsImNvbmZpZyIsImRhdGFiYXNlIiwibG9hZFNjaGVtYSIsImNsZWFyQ2FjaGUiLCJ0aGVuIiwic2NoZW1hQ29udHJvbGxlciIsImdldEFsbENsYXNzZXMiLCJzY2hlbWFzIiwicmVzcG9uc2UiLCJyZXN1bHRzIiwiZ2V0T25lU2NoZW1hIiwiY2xhc3NOYW1lIiwicGFyYW1zIiwic2NoZW1hIiwiY2F0Y2giLCJlcnJvciIsInVuZGVmaW5lZCIsIklOVEVSTkFMX1NFUlZFUl9FUlJPUiIsImNoZWNrSWZEZWZpbmVkU2NoZW1hc0lzVXNlZCIsIl9yZXEkY29uZmlnIiwibG9ja1NjaGVtYXMiLCJPUEVSQVRJT05fRk9SQklEREVOIiwiaW50ZXJuYWxDcmVhdGVTY2hlbWEiLCJib2R5IiwiY29udHJvbGxlciIsImFkZENsYXNzSWZOb3RFeGlzdHMiLCJmaWVsZHMiLCJjbGFzc0xldmVsUGVybWlzc2lvbnMiLCJpbmRleGVzIiwiZXhwb3J0cyIsImludGVybmFsVXBkYXRlU2NoZW1hIiwidXBkYXRlQ2xhc3MiLCJjcmVhdGVTY2hlbWEiLCJhdXRoIiwiaXNSZWFkT25seSIsInBhdGgiLCJtb2RpZnlTY2hlbWEiLCJkZWxldGVTY2hlbWEiLCJjbGFzc05hbWVJc1ZhbGlkIiwiaW52YWxpZENsYXNzTmFtZU1lc3NhZ2UiLCJTY2hlbWFzUm91dGVyIiwiUHJvbWlzZVJvdXRlciIsIm1vdW50Um91dGVzIiwicm91dGUiLCJwcm9taXNlRW5mb3JjZU1hc3RlcktleUFjY2VzcyJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Sb3V0ZXJzL1NjaGVtYXNSb3V0ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc2NoZW1hcy5qc1xuXG52YXIgUGFyc2UgPSByZXF1aXJlKCdwYXJzZS9ub2RlJykuUGFyc2UsXG4gIFNjaGVtYUNvbnRyb2xsZXIgPSByZXF1aXJlKCcuLi9Db250cm9sbGVycy9TY2hlbWFDb250cm9sbGVyJyk7XG5cbmltcG9ydCBQcm9taXNlUm91dGVyIGZyb20gJy4uL1Byb21pc2VSb3V0ZXInO1xuaW1wb3J0ICogYXMgbWlkZGxld2FyZSBmcm9tICcuLi9taWRkbGV3YXJlcyc7XG5cbmZ1bmN0aW9uIGNsYXNzTmFtZU1pc21hdGNoUmVzcG9uc2UoYm9keUNsYXNzLCBwYXRoQ2xhc3MpIHtcbiAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFxuICAgIFBhcnNlLkVycm9yLklOVkFMSURfQ0xBU1NfTkFNRSxcbiAgICBgQ2xhc3MgbmFtZSBtaXNtYXRjaCBiZXR3ZWVuICR7Ym9keUNsYXNzfSBhbmQgJHtwYXRoQ2xhc3N9LmBcbiAgKTtcbn1cblxuZnVuY3Rpb24gZ2V0QWxsU2NoZW1hcyhyZXEpIHtcbiAgcmV0dXJuIHJlcS5jb25maWcuZGF0YWJhc2VcbiAgICAubG9hZFNjaGVtYSh7IGNsZWFyQ2FjaGU6IHRydWUgfSlcbiAgICAudGhlbihzY2hlbWFDb250cm9sbGVyID0+IHNjaGVtYUNvbnRyb2xsZXIuZ2V0QWxsQ2xhc3Nlcyh7IGNsZWFyQ2FjaGU6IHRydWUgfSkpXG4gICAgLnRoZW4oc2NoZW1hcyA9PiAoeyByZXNwb25zZTogeyByZXN1bHRzOiBzY2hlbWFzIH0gfSkpO1xufVxuXG5mdW5jdGlvbiBnZXRPbmVTY2hlbWEocmVxKSB7XG4gIGNvbnN0IGNsYXNzTmFtZSA9IHJlcS5wYXJhbXMuY2xhc3NOYW1lO1xuICByZXR1cm4gcmVxLmNvbmZpZy5kYXRhYmFzZVxuICAgIC5sb2FkU2NoZW1hKHsgY2xlYXJDYWNoZTogdHJ1ZSB9KVxuICAgIC50aGVuKHNjaGVtYUNvbnRyb2xsZXIgPT4gc2NoZW1hQ29udHJvbGxlci5nZXRPbmVTY2hlbWEoY2xhc3NOYW1lLCB0cnVlKSlcbiAgICAudGhlbihzY2hlbWEgPT4gKHsgcmVzcG9uc2U6IHNjaGVtYSB9KSlcbiAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgaWYgKGVycm9yID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFBhcnNlLkVycm9yLklOVkFMSURfQ0xBU1NfTkFNRSwgYENsYXNzICR7Y2xhc3NOYW1lfSBkb2VzIG5vdCBleGlzdC5gKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihQYXJzZS5FcnJvci5JTlRFUk5BTF9TRVJWRVJfRVJST1IsICdEYXRhYmFzZSBhZGFwdGVyIGVycm9yLicpO1xuICAgICAgfVxuICAgIH0pO1xufVxuXG5jb25zdCBjaGVja0lmRGVmaW5lZFNjaGVtYXNJc1VzZWQgPSByZXEgPT4ge1xuICBpZiAocmVxLmNvbmZpZz8uc2NoZW1hPy5sb2NrU2NoZW1hcyA9PT0gdHJ1ZSkge1xuICAgIHRocm93IG5ldyBQYXJzZS5FcnJvcihcbiAgICAgIFBhcnNlLkVycm9yLk9QRVJBVElPTl9GT1JCSURERU4sXG4gICAgICAnQ2Fubm90IHBlcmZvcm0gdGhpcyBvcGVyYXRpb24gd2hlbiBzY2hlbWFzIG9wdGlvbnMgaXMgdXNlZC4nXG4gICAgKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGludGVybmFsQ3JlYXRlU2NoZW1hID0gYXN5bmMgKGNsYXNzTmFtZSwgYm9keSwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGNvbnRyb2xsZXIgPSBhd2FpdCBjb25maWcuZGF0YWJhc2UubG9hZFNjaGVtYSh7IGNsZWFyQ2FjaGU6IHRydWUgfSk7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY29udHJvbGxlci5hZGRDbGFzc0lmTm90RXhpc3RzKFxuICAgIGNsYXNzTmFtZSxcbiAgICBib2R5LmZpZWxkcyxcbiAgICBib2R5LmNsYXNzTGV2ZWxQZXJtaXNzaW9ucyxcbiAgICBib2R5LmluZGV4ZXNcbiAgKTtcbiAgcmV0dXJuIHtcbiAgICByZXNwb25zZSxcbiAgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBpbnRlcm5hbFVwZGF0ZVNjaGVtYSA9IGFzeW5jIChjbGFzc05hbWUsIGJvZHksIGNvbmZpZykgPT4ge1xuICBjb25zdCBjb250cm9sbGVyID0gYXdhaXQgY29uZmlnLmRhdGFiYXNlLmxvYWRTY2hlbWEoeyBjbGVhckNhY2hlOiB0cnVlIH0pO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNvbnRyb2xsZXIudXBkYXRlQ2xhc3MoXG4gICAgY2xhc3NOYW1lLFxuICAgIGJvZHkuZmllbGRzIHx8IHt9LFxuICAgIGJvZHkuY2xhc3NMZXZlbFBlcm1pc3Npb25zLFxuICAgIGJvZHkuaW5kZXhlcyxcbiAgICBjb25maWcuZGF0YWJhc2VcbiAgKTtcbiAgcmV0dXJuIHsgcmVzcG9uc2UgfTtcbn07XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVNjaGVtYShyZXEpIHtcbiAgY2hlY2tJZkRlZmluZWRTY2hlbWFzSXNVc2VkKHJlcSk7XG4gIGlmIChyZXEuYXV0aC5pc1JlYWRPbmx5KSB7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFxuICAgICAgUGFyc2UuRXJyb3IuT1BFUkFUSU9OX0ZPUkJJRERFTixcbiAgICAgIFwicmVhZC1vbmx5IG1hc3RlcktleSBpc24ndCBhbGxvd2VkIHRvIGNyZWF0ZSBhIHNjaGVtYS5cIlxuICAgICk7XG4gIH1cbiAgaWYgKHJlcS5wYXJhbXMuY2xhc3NOYW1lICYmIHJlcS5ib2R5LmNsYXNzTmFtZSkge1xuICAgIGlmIChyZXEucGFyYW1zLmNsYXNzTmFtZSAhPSByZXEuYm9keS5jbGFzc05hbWUpIHtcbiAgICAgIHJldHVybiBjbGFzc05hbWVNaXNtYXRjaFJlc3BvbnNlKHJlcS5ib2R5LmNsYXNzTmFtZSwgcmVxLnBhcmFtcy5jbGFzc05hbWUpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGNsYXNzTmFtZSA9IHJlcS5wYXJhbXMuY2xhc3NOYW1lIHx8IHJlcS5ib2R5LmNsYXNzTmFtZTtcbiAgaWYgKCFjbGFzc05hbWUpIHtcbiAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoMTM1LCBgUE9TVCAke3JlcS5wYXRofSBuZWVkcyBhIGNsYXNzIG5hbWUuYCk7XG4gIH1cblxuICByZXR1cm4gYXdhaXQgaW50ZXJuYWxDcmVhdGVTY2hlbWEoY2xhc3NOYW1lLCByZXEuYm9keSwgcmVxLmNvbmZpZyk7XG59XG5cbmZ1bmN0aW9uIG1vZGlmeVNjaGVtYShyZXEpIHtcbiAgY2hlY2tJZkRlZmluZWRTY2hlbWFzSXNVc2VkKHJlcSk7XG4gIGlmIChyZXEuYXV0aC5pc1JlYWRPbmx5KSB7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFxuICAgICAgUGFyc2UuRXJyb3IuT1BFUkFUSU9OX0ZPUkJJRERFTixcbiAgICAgIFwicmVhZC1vbmx5IG1hc3RlcktleSBpc24ndCBhbGxvd2VkIHRvIHVwZGF0ZSBhIHNjaGVtYS5cIlxuICAgICk7XG4gIH1cbiAgaWYgKHJlcS5ib2R5LmNsYXNzTmFtZSAmJiByZXEuYm9keS5jbGFzc05hbWUgIT0gcmVxLnBhcmFtcy5jbGFzc05hbWUpIHtcbiAgICByZXR1cm4gY2xhc3NOYW1lTWlzbWF0Y2hSZXNwb25zZShyZXEuYm9keS5jbGFzc05hbWUsIHJlcS5wYXJhbXMuY2xhc3NOYW1lKTtcbiAgfVxuICBjb25zdCBjbGFzc05hbWUgPSByZXEucGFyYW1zLmNsYXNzTmFtZTtcblxuICByZXR1cm4gaW50ZXJuYWxVcGRhdGVTY2hlbWEoY2xhc3NOYW1lLCByZXEuYm9keSwgcmVxLmNvbmZpZyk7XG59XG5cbmNvbnN0IGRlbGV0ZVNjaGVtYSA9IHJlcSA9PiB7XG4gIGlmIChyZXEuYXV0aC5pc1JlYWRPbmx5KSB7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFxuICAgICAgUGFyc2UuRXJyb3IuT1BFUkFUSU9OX0ZPUkJJRERFTixcbiAgICAgIFwicmVhZC1vbmx5IG1hc3RlcktleSBpc24ndCBhbGxvd2VkIHRvIGRlbGV0ZSBhIHNjaGVtYS5cIlxuICAgICk7XG4gIH1cbiAgaWYgKCFTY2hlbWFDb250cm9sbGVyLmNsYXNzTmFtZUlzVmFsaWQocmVxLnBhcmFtcy5jbGFzc05hbWUpKSB7XG4gICAgdGhyb3cgbmV3IFBhcnNlLkVycm9yKFxuICAgICAgUGFyc2UuRXJyb3IuSU5WQUxJRF9DTEFTU19OQU1FLFxuICAgICAgU2NoZW1hQ29udHJvbGxlci5pbnZhbGlkQ2xhc3NOYW1lTWVzc2FnZShyZXEucGFyYW1zLmNsYXNzTmFtZSlcbiAgICApO1xuICB9XG4gIHJldHVybiByZXEuY29uZmlnLmRhdGFiYXNlLmRlbGV0ZVNjaGVtYShyZXEucGFyYW1zLmNsYXNzTmFtZSkudGhlbigoKSA9PiAoeyByZXNwb25zZToge30gfSkpO1xufTtcblxuZXhwb3J0IGNsYXNzIFNjaGVtYXNSb3V0ZXIgZXh0ZW5kcyBQcm9taXNlUm91dGVyIHtcbiAgbW91bnRSb3V0ZXMoKSB7XG4gICAgdGhpcy5yb3V0ZSgnR0VUJywgJy9zY2hlbWFzJywgbWlkZGxld2FyZS5wcm9taXNlRW5mb3JjZU1hc3RlcktleUFjY2VzcywgZ2V0QWxsU2NoZW1hcyk7XG4gICAgdGhpcy5yb3V0ZShcbiAgICAgICdHRVQnLFxuICAgICAgJy9zY2hlbWFzLzpjbGFzc05hbWUnLFxuICAgICAgbWlkZGxld2FyZS5wcm9taXNlRW5mb3JjZU1hc3RlcktleUFjY2VzcyxcbiAgICAgIGdldE9uZVNjaGVtYVxuICAgICk7XG4gICAgdGhpcy5yb3V0ZSgnUE9TVCcsICcvc2NoZW1hcycsIG1pZGRsZXdhcmUucHJvbWlzZUVuZm9yY2VNYXN0ZXJLZXlBY2Nlc3MsIGNyZWF0ZVNjaGVtYSk7XG4gICAgdGhpcy5yb3V0ZShcbiAgICAgICdQT1NUJyxcbiAgICAgICcvc2NoZW1hcy86Y2xhc3NOYW1lJyxcbiAgICAgIG1pZGRsZXdhcmUucHJvbWlzZUVuZm9yY2VNYXN0ZXJLZXlBY2Nlc3MsXG4gICAgICBjcmVhdGVTY2hlbWFcbiAgICApO1xuICAgIHRoaXMucm91dGUoXG4gICAgICAnUFVUJyxcbiAgICAgICcvc2NoZW1hcy86Y2xhc3NOYW1lJyxcbiAgICAgIG1pZGRsZXdhcmUucHJvbWlzZUVuZm9yY2VNYXN0ZXJLZXlBY2Nlc3MsXG4gICAgICBtb2RpZnlTY2hlbWFcbiAgICApO1xuICAgIHRoaXMucm91dGUoXG4gICAgICAnREVMRVRFJyxcbiAgICAgICcvc2NoZW1hcy86Y2xhc3NOYW1lJyxcbiAgICAgIG1pZGRsZXdhcmUucHJvbWlzZUVuZm9yY2VNYXN0ZXJLZXlBY2Nlc3MsXG4gICAgICBkZWxldGVTY2hlbWFcbiAgICApO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUtBLElBQUFBLGNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFVBQUEsR0FBQUMsdUJBQUEsQ0FBQUYsT0FBQTtBQUE2QyxTQUFBRyx5QkFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxtQkFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBRix3QkFBQSxZQUFBQSxDQUFBQyxDQUFBLFdBQUFBLENBQUEsR0FBQUcsQ0FBQSxHQUFBRCxDQUFBLEtBQUFGLENBQUE7QUFBQSxTQUFBRix3QkFBQUUsQ0FBQSxFQUFBRSxDQUFBLFNBQUFBLENBQUEsSUFBQUYsQ0FBQSxJQUFBQSxDQUFBLENBQUFJLFVBQUEsU0FBQUosQ0FBQSxlQUFBQSxDQUFBLHVCQUFBQSxDQUFBLHlCQUFBQSxDQUFBLFdBQUFL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